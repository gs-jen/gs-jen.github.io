<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=windows-1252">
    <title>Creating Table of Content</title><script language="javascript" type="text/javascript">
function hidediv( divname )
{
    document.getElementById( divname ).style.display = 'none';
}

function showdiv( divname )
{
    document.getElementById( divname ).style.display = 'inline';
}
</script><style type="text/css">
    body
    {
        color:#444444;
        background-color:white;
        font-family:Trebuchet MS, Arial;
        font-size:10pt;
    }
    A:link
    {
        color:#0068be;
        font-family:Trebuchet MS, Arial;
        font-size:10pt;
        cursor:pointer;
    }
    A:visited
    {
        color:#039CCF;
        font-family:Trebuchet MS, Arial;
        font-size:10pt;
        cursor:pointer;
    }
    p, h1, h2, h3, h4, h5, h6
    {
        font-family : Trebuchet MS, Arial;
    }

    pre.example
    {
        background-color : #f1f1f1;
    }

    ul, ul.main
    {
        list-style-type : disc;
        margin-left: 18pt;
    }
    ol, ol.main
    {
        list-style-type: decimal;
        margin-left: 18pt;
    }
    li
    {
        font-family : Trebuchet MS, Arial;
    }
    ul.hhc
    {
        list-style-type : none;
        margin-left : 1em;
        padding : 0;
        padding-left : 0;
        text-indent : 0;
    }
    li.hhc
    {
        font-family : Trebuchet MS, Arial;
        margin-left : 0;
        padding : 0;
        padding-left : 0;
        text-indent : 0;
    }
    
    table, table.tmain
    {
        font-size:10pt;
        border-collapse : collapse;
        border : 1px solid;
        border-color : #dfe3e7;
    }
    td.tmain, td.tmain_nw, td.thdr
    {
        border : 1px solid;
        border-color : #dfe3e7;
        background-color : rgb(255, 255, 255);
        vertical-align : top;
        padding : 3px;
        font-family : Trebuchet MS, Arial;
    }
    td.tmain p, td.tmain_nw p, td.thdr p
    {
        margin-bottom : 6pt;
    }
    td.tmain_nw
    {
        white-space : nowrap;
    }
    td.thdr
    {
        font-size:10pt;
        background-color : #f1f1f1;
    }
    table.decl
    {
        border : 0px none;
        background-color : rgb(192, 192, 192);
        vertical-align : top;
        padding : 3px;
        font-family : Trebuchet MS, Arial;
        width : 100%;
    }
</style></head>
  <body>
    <p>
      <font size="+1"><b>Creating Table of Content</b></font>
    </p>
    <p><b>Brief</b></p>
    <p>The article describes how to create a table of content in a document.</p>
    <p><b>Details</b></p><p>You can create a table of content (TOC), or an <i>outline</i>, at the end or in some other place in your document.
A TOC includes the paragraphs marked as TOC items which precede the TOC, no matter whether they are in one section or not.
You can have several TOCs in one document. Items in a TOC are clickable, so you can quickly navigate to the corresponding paragraphs in the document.</p>
<p>To mark a paragraph as a TOC item, call the method <a href="Gehtsoft.PDFFlow.Builder.ParagraphBuilder.SetOutline.3gB.html"><code>ParagraphBuilder.SetOutline</code></a>.
In this case, the paragraph text and page number will appear in the TOC.<br>
If you call the method without the parameter, the item level will be set to <code>0</code> and have no indent.
If you create a multilevel TOC, specify the item level in the <code>OutlineLevel</code> parameter. The items with non-zero level values will be shifted to the left depending on their level.</p>
<p>To add a TOC to a document, call one of the <code>AddOutline()</code> methods of the <a href="Gehtsoft.PDFFlow.Builder.OutlineExtensions.html"><code>OutlineExtensions</code></a> class for your document.
When you add a TOC to your document, a separate section is created for it under the hood, so you can configure the margin, paper size, and page orientation settings for your TOC.
If you do not specify any of these settings, they will have their default values defined by the default style, that is, <code>20f</code> margins, the <code>Letter</code> paper size, and the <code>Landscape</code> page orientation.
Along with these settings, you can configure the settings specific for the TOC: its font, caption, indent, and caption font. If not specified, they will also have their default values defined by the default style.</p><ul class="main">
  <li><p>To add a TOC and configure its settings in the method parameters, call the <a href="Gehtsoft.PDFFlow.Builder.OutlineExtensions.AddOutline.z5F.html"><code>AddOutline</code></a> method.</p></li>
  <li><p>To add a TOC and configure it by a configuration action, call the <a href="Gehtsoft.PDFFlow.Builder.OutlineExtensions.AddOutline.mKG.html"><code>AddOutline</code></a> method.</p></li>
</ul><p>Both methods return an instance of the <a href="Gehtsoft.PDFFlow.Builder.OutlineBuilder.html"><code>OutlineBuilder</code></a> class that is derived from the
<a href="Gehtsoft.PDFFlow.Builder.FormattedTextElementBuilder.html"><code>FormattedTextElementBuilder</code></a>, so you can use all its methods to configure the TOC,
for example, <code>SetFont()</code>, <code>SetUnderline()</code>.</p>
<p>You can configure the TOC using methods of the <a href="Gehtsoft.PDFFlow.Builder.OutlineBuilder.html"><code>OutlineBuilder</code></a> class.</p>
<p>To set the text and font for the TOC caption, you can use one of the following options:</p><ul class="main">
  <li><p>Set the caption text using the <a href="Gehtsoft.PDFFlow.Builder.OutlineBuilder.SetCaption.yF4.html"><code>SetCaption</code></a> method and then set the
caption font using the <a href="Gehtsoft.PDFFlow.Builder.OutlineBuilder.SetCaptionFont.wn4.html"><code>SetCaptionFont</code></a> method.</p></li>
  <li><p>Set the caption text and font using the <a href="Gehtsoft.PDFFlow.Builder.OutlineBuilder.SetCaption.KLF.html"><code>SetCaption</code></a> method.</p></li>
</ul><p>To set the background color for the caption, call the <a href="Gehtsoft.PDFFlow.Builder.OutlineBuilder.SetCaptionBackColor.XZ1.html"><code>SetCaptionBackColor</code></a> method.</p>
<p>You can also configure the line leader between the texts of TOC items and the page numbers using the methods
<a href="Gehtsoft.PDFFlow.Builder.OutlineBuilder.SetSpacingUnderline.wxD.html"><code>SetSpacingUnderline</code></a>,
<a href="Gehtsoft.PDFFlow.Builder.OutlineBuilder.SetSpacingUnderlineStroke.z2.html"><code>SetSpacingUnderlineStroke</code></a>, and
<a href="Gehtsoft.PDFFlow.Builder.OutlineBuilder.SetSpacingUnderlineColor.lA6.html"><code>SetSpacingUnderlineColor</code></a>.</p>
<p><br><br>
<b>See also</b></p>
<p><a href="CreatingDocument.html">Creating Document</a></p>
<p><a href="AddingParagraph.html">Adding Paragraph</a></p>
<p><br><br>
<b>Examples</b></p><div id="open138" style="display:none">
  <p>Example 1. Create a simple table of content&nbsp;<a href="javascript: showdiv('close138'); hidediv('open138');" onclick="javascript: showdiv('close138'); hidediv('open138');">[show]</a></p>
</div>
<div id="close138" style="display:inline">
  <p>Example 1. Create a simple table of content&nbsp;<a href="javascript: showdiv('open138'); hidediv('close138');" onclick="javascript: showdiv('open138'); hidediv('close138');">[hide]</a></p>
  <pre class="example" id="example138"><code>            DocumentBuilder.New()
                .AddSection()
                    .AddParagraph(&quot;Chapter I&quot;)
                        .SetOutline()
                .ToSection()
                    .AddParagraph(&quot;Text of chapter I&quot;)
                .ToSection()
                    .AddParagraph(&quot;Chapter II&quot;)
                        .SetOutline()
                .ToSection()
                    .AddParagraph(&quot;Text of chapter II&quot;)
                .ToSection()
                    .AddParagraph(&quot;Chapter III&quot;)
                        .SetOutline()
                .ToSection()
                    .AddParagraph(&quot;Text of chapter III&quot;)
            .ToDocument()
                .AddOutline()
            .ToDocument()
                .Build(&quot;Result.pdf&quot;);
 
 <b>The above code will generate the following:</b>
 
 <img src="img/creating-outline-ex1.png">
 <a href="pdf/Sample_CreatingOutline1.pdf" target="_blank">See the document</a></code></pre>
</div><div id="open139" style="display:none">
  <p>Example 2. Create a multilevel table of content&nbsp;<a href="javascript: showdiv('close139'); hidediv('open139');" onclick="javascript: showdiv('close139'); hidediv('open139');">[show]</a></p>
</div>
<div id="close139" style="display:inline">
  <p>Example 2. Create a multilevel table of content&nbsp;<a href="javascript: showdiv('open139'); hidediv('close139');" onclick="javascript: showdiv('open139'); hidediv('close139');">[hide]</a></p>
  <pre class="example" id="example139"><code>            DocumentBuilder.New()
             <b>// Add content and mark some paragraphs as TOC items:</b>
                .AddSection()
                    .AddParagraph(&quot;Chapter I&quot;)
                     <b>// Set the higher level:</b>
                        .SetOutline(0)
                .ToSection()
                    .AddParagraph(&quot;Text of chapter I&quot;)
                .ToSection()
                    .AddParagraph(&quot;Chapter I.1&quot;)
                     <b>// Set the first sub-level:</b>
                        .SetOutline(1)
                .ToSection()
                    .AddParagraph(&quot;Text of chapter I.1&quot;)
                .ToSection()
                    .AddParagraph(&quot;Chapter I.2&quot;)
                        .SetOutline(1)
                .ToSection()
                    .AddParagraph(&quot;Text of chapter I.2&quot;)
                .ToSection()
                    .AddParagraph(&quot;Chapter I.2.a&quot;)
                     <b>// Set the second sub-level:</b>
                        .SetOutline(2)
                .ToSection()
                    .AddParagraph(&quot;Text of chapter I.2.a&quot;)
                .ToSection()
                    .AddParagraph(&quot;Chapter I.2.a&quot;)
                        .SetOutline(2)
                .ToSection()
                    .AddParagraph(&quot;Text of chapter I.2.a&quot;)
                .ToSection()
                    .AddParagraph(&quot;Chapter II&quot;)
                        .SetOutline(0)
            .ToDocument()
             <b>// Add a TOC to the document and set the left indent to 20:</b>
                .AddOutline(outlineCaption:&quot;Outline&quot;, levelLeftIndent:20)
            .ToDocument()
                .Build(&quot;Result.pdf&quot;);
 
 <b>The above code will generate the following:</b>
 
 <img src="img/creating-outline-ex2.png">
 <a href="pdf/Sample_CreatingOutline2.pdf" target="_blank">See the document</a></code></pre>
</div><div id="open140" style="display:none">
  <p>Example 3. Create a table of content in the middle of a document&nbsp;<a href="javascript: showdiv('close140'); hidediv('open140');" onclick="javascript: showdiv('close140'); hidediv('open140');">[show]</a></p>
</div>
<div id="close140" style="display:inline">
  <p>Example 3. Create a table of content in the middle of a document&nbsp;<a href="javascript: showdiv('open140'); hidediv('close140');" onclick="javascript: showdiv('open140'); hidediv('close140');">[hide]</a></p>
  <pre class="example" id="example140"><code>            DocumentBuilder.New()
                .AddSection()
                    .AddParagraph(&quot;Chapter I&quot;)
                        .SetOutline()
                .ToSection()
                    .AddParagraph(&quot;Text of chapter I&quot;)
                .ToSection()
                    .AddParagraph(&quot;Chapter II&quot;)
                        .SetOutline()
                .ToSection()
                    .AddParagraph(&quot;Text of chapter II&quot;)
            .ToDocument()
                .AddOutline()
            .ToDocument()
                .AddSection()
                    .AddParagraph(&quot;Chapter III&quot;)
                        .SetOutline()
                .ToSection()
                    .AddParagraph(&quot;Text of chapter III&quot;)
            .ToDocument()
                .Build(&quot;Result.pdf&quot;);
 
 <b>The above code will generate the following:</b>
 
 <img src="img/creating-outline-ex3.png">
 <a href="pdf/Sample_CreatingOutline3.pdf" target="_blank">See the document</a></code></pre>
</div><div id="open141" style="display:none">
  <p>Example 4. Create a table of content with a line leader&nbsp;<a href="javascript: showdiv('close141'); hidediv('open141');" onclick="javascript: showdiv('close141'); hidediv('open141');">[show]</a></p>
</div>
<div id="close141" style="display:inline">
  <p>Example 4. Create a table of content with a line leader&nbsp;<a href="javascript: showdiv('open141'); hidediv('close141');" onclick="javascript: showdiv('open141'); hidediv('close141');">[hide]</a></p>
  <pre class="example" id="example141"><code>            DocumentBuilder.New()
                .AddSection()
                    .AddParagraph(&quot;Chapter I&quot;)
                        .SetOutline(0)
                .ToSection()
                    .AddParagraph(&quot;Text of chapter I&quot;)
                .ToSection()
                    .AddParagraph(&quot;Chapter I.1&quot;)
                        .SetOutline(1)
                .ToSection()
                    .AddParagraph(&quot;Text of chapter I.1&quot;)
                .ToSection()
                    .AddParagraph(&quot;Chapter I.1.a&quot;)
                        .SetOutline(2)
                .ToSection()
                    .AddParagraph(&quot;Text of chapter I.1.a&quot;)
            .ToDocument()
                .AddOutline()
                 <b>// Set the Red Dotted line leader between the TOC item text and the page number:</b>
                    .SetSpacingUnderline(Stroke.Dotted, Color.Red)
                 <b>// Shift levels from the left:</b>
                    .SetLevelLeftIndent(15)
            .ToDocument()
                .Build(&quot;Result.pdf&quot;);
 
 <b>The above code will generate the following:</b>
 
 <img src="img/creating-outline-ex4.png">
 <a href="pdf/Sample_CreatingOutline4.pdf" target="_blank">See the document</a></code></pre>
</div><div id="open142" style="display:none">
  <p>Example 5. Create a table of content with setting fonts and colors using the parameters of the <code>AddOutline</code> method&nbsp;<a href="javascript: showdiv('close142'); hidediv('open142');" onclick="javascript: showdiv('close142'); hidediv('open142');">[show]</a></p>
</div>
<div id="close142" style="display:inline">
  <p>Example 5. Create a table of content with setting fonts and colors using the parameters of the <code>AddOutline</code> method&nbsp;<a href="javascript: showdiv('open142'); hidediv('close142');" onclick="javascript: showdiv('open142'); hidediv('close142');">[hide]</a></p>
  <pre class="example" id="example142"><code>            DocumentBuilder.New()
                .AddSection()
                    .AddParagraph(&quot;Chapter I&quot;)
                        .SetOutline()
                .ToSection()
                    .AddParagraph(&quot;Text of chapter I&quot;)
                .ToSection()
                    .AddParagraph(&quot;Chapter II&quot;)
                        .SetOutline()
                .ToSection()
                    .AddParagraph(&quot;Text of chapter II&quot;)
            .ToDocument()
             <b>// Set Fonts in the AddOutline method:</b>
                .AddOutline(
                    outlineCaption: &quot;Outline&quot;,
                    outlineFont: Fonts.Courier(16).SetColor(Color.Green),
                    captionFont: Fonts.Times(20).SetColor(Color.Red).SetBold().SetUnderline(Stroke.Double, Color.Blue)
                        )
                 <b>// Spacing color will be Green as defined by the TOC font:</b>
                    .SetSpacingUnderlineStroke(Stroke.Dashed)
            .ToDocument()
                .Build(&quot;Result.pdf&quot;);
 
 <b>The above code will generate the following:</b>
 
 <img src="img/creating-outline-ex5.png">
 <a href="pdf/Sample_CreatingOutline5.pdf" target="_blank">See the document</a></code></pre>
</div><div id="open143" style="display:none">
  <p>Example 6. Create a table of content with setting fonts and colors using the methods of the <code>OutlineBuilder</code> class&nbsp;<a href="javascript: showdiv('close143'); hidediv('open143');" onclick="javascript: showdiv('close143'); hidediv('open143');">[show]</a></p>
</div>
<div id="close143" style="display:inline">
  <p>Example 6. Create a table of content with setting fonts and colors using the methods of the <code>OutlineBuilder</code> class&nbsp;<a href="javascript: showdiv('open143'); hidediv('close143');" onclick="javascript: showdiv('open143'); hidediv('close143');">[hide]</a></p>
  <pre class="example" id="example143"><code>            DocumentBuilder.New()
                .AddSection()
                    .AddParagraph(&quot;Chapter I&quot;)
                        .SetOutline()
                .ToSection()
                    .AddParagraph(&quot;Text of chapter I&quot;)
                .ToSection()
                    .AddParagraph(&quot;Chapter II&quot;)
                            !.SetOutline()
                .ToSection()
                    .AddParagraph(&quot;Text of chapter II&quot;)
            .ToDocument()
                .AddOutline(&quot;Outline&quot;)
                 <b>// Set Fonts using the OutlineBuilder methods:</b>
                    .SetCaptionFont(Fonts.Times(20).SetColor(Color.Red).SetBold().SetUnderline(Stroke.Double, Color.Blue))
                    .SetOutlineFont(Fonts.Courier(16).SetColor(Color.Green))
                 <b>// The line leader color will be Green as defined by the TOC font:</b>
                    .SetSpacingUnderlineStroke(Stroke.Dashed)
            .ToDocument()
                .Build(&quot;Result.pdf&quot;);
 
 <b>The above code will generate the following:</b>
 
 <img src="img/creating-outline-ex6.png">
 <a href="pdf/Sample_CreatingOutline6.pdf" target="_blank">See the document</a></code></pre>
</div><div id="open144" style="display:none">
  <p>Example 7. Support of several sections&nbsp;<a href="javascript: showdiv('close144'); hidediv('open144');" onclick="javascript: showdiv('close144'); hidediv('open144');">[show]</a></p>
</div>
<div id="close144" style="display:inline">
  <p>Example 7. Support of several sections&nbsp;<a href="javascript: showdiv('open144'); hidediv('close144');" onclick="javascript: showdiv('open144'); hidediv('close144');">[hide]</a></p>
  <pre class="example" id="example144"><code>            DocumentBuilder.New()
             <b>// Section 1:</b>
                .AddSection()
                    .AddParagraph(&quot;Section 1. Chapter I&quot;)
                        .SetOutline()
                .ToSection()
                    .AddParagraph(&quot;Text of chapter I&quot;)
                .ToSection()
                    .AddParagraph(&quot;Section 1. Chapter II&quot;)
                        .SetOutline()
                .ToSection()
                    .AddParagraph(&quot;Text of chapter II&quot;)
            .ToDocument()
             <b>// Section 2:</b>
                .AddSection()
                    .AddParagraph(&quot;Section 2. Chapter I&quot;)
                        .SetOutline()
                .ToSection()
                    .AddParagraph(&quot;Text of chapter I&quot;)
                .ToSection()
                    .AddParagraph(&quot;Section 2. Chapter II&quot;)
                        .SetOutline()
                .ToSection()
                    .AddParagraph(&quot;Text of chapter II&quot;)
            .ToDocument()
             <b>// This TOC will contain items from both sections before calling AddOutline:</b>
                .AddOutline(&quot;Outline&quot;)
            .ToDocument()
                .Build(&quot;Result.pdf&quot;);
 
 <b>The above code will generate the following:</b>
 
 <img src="img/creating-outline-ex7.png">
 <a href="pdf/Sample_CreatingOutline7.pdf" target="_blank">See the document</a></code></pre>
</div><p>
      <center><a href="tutorials.html">back</a></center>
    </p><script language="javascript" type="text/javascript">if(window.parent.frames[0]) window.parent.frames[0].selectItem(window.location.href);</script></body>
</html>